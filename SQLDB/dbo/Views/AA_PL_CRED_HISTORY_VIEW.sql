CREATE VIEW AA_PL_CRED_HISTORY_VIEW

/*
** Written: 16/08/04 DB
** Last Amended: 11/05/2005 WW, 13/06/05 NC, 23/1/2007 WW, 27/9/2007 WW
*/

(
  PT_PRIMARY,
  P_AL_PRIMARY,
  P_AL_DATE,
  P_AL_PERIOD,
  P_AL_YEAR,
  P_AL_VALUE_HOME,
  P_AL_VALUE_CURR,
  P_AL_REFERENCE,
  P_AL_HEADER_KEY,
  P_AL_USER_ID,
  P_AL_ACCOUNT_CODE,
  P_AL_FULLALLOC_PD,
  P_AL_FULLALLOC_DATE,
  PT_TRI_RATE1,
  PT_TRI_RATE2,
  PT_CURRENCYCODE,
  PT_TRANTYPE,
  PT_HEADER_REF,
  PT_INTERNAL_REF,
  PT_DESCRIPTION,
  PT_DATE,
  PT_DUEDATE,
  PT_GROSS,
  PT_CURR_VALU,
  PT_YEAR,
  PT_PERIODNUMBER,
  PT_GROSS_BASE2,
  PT_QUERY_FLAG,
  PT_USER1,
  PT_USER2,
  PT_USER3,
  SUCODE,
  SUNAME,
  SU_CREDIT_LIMIT,
  SUCURRENCYCODE,
  SU_MULTI_CURR,
  SU_CURRENCY_CHANGED,
  SUCONTACT,
  SUPHONE,
  SUFAX,
  SU_TERMS,
  SU_DUE_DAYS,
  SU_DUEDATE_TYPE,
  SU_A_P_DAYS,
  SU_SETT_DAYS1,
  SU_SETT_DAYS2,
  SU_SETT_DISC1,
  SU_SETT_DISC2,
  SUUSER1,
  SUUSER2,
  SUUSER3,
  SU_NOTES,
  SUSORT,
  SUPOSTCODE,
  SUBALANCE,
  SUTURNOVERYTD,
  SU_ON_STOP,
  SU_PRIMARY,
  SU_DO_NOT_USE,
  SU_CURR_CREDIT_LIMIT,
  SUBALANCE_C
)
as

select
  PT_PRIMARY,
  P_AL_PRIMARY,
  P_AL_DATE,
  P_AL_PERIOD,
  P_AL_YEAR,
  P_AL_VALUE_HOME,
  P_AL_VALUE_CURR,
  P_AL_REFERENCE,
  P_AL_HEADER_KEY,
  P_AL_USER_ID,
  P_AL_ACCOUNT_CODE,
  P_AL_FULLALLOC_PD,
  P_AL_FULLALLOC_DATE,
  PT_TRI_RATE1,
  PT_TRI_RATE2,
  PT_CURRENCYCODE,
  PT_TRANTYPE,
  PT_HEADER_REF,
  PT_INTERNAL_REF,
  PT_DESCRIPTION,
  PT_DATE,
  PT_DUEDATE,
  PT_GROSS,
  PT_CURR_VALU,
  PT_YEAR,
  PT_PERIODNUMBER,
  PT_GROSS_BASE2,
  PT_QUERY_FLAG,
  PT_USER1,
  PT_USER2,
  PT_USER3,
  SUCODE,
  SUNAME,
  SU_CREDIT_LIMIT,
  SUCURRENCYCODE,
  SU_MULTI_CURR,
  SU_CURRENCY_CHANGED,
  SUCONTACT,
  SUPHONE,
  SUFAX,
  SU_TERMS,
  SU_DUE_DAYS,
  SU_DUEDATE_TYPE,
  SU_A_P_DAYS,
  SU_SETT_DAYS1,
  SU_SETT_DAYS2,
  SU_SETT_DISC1,
  SU_SETT_DISC2,
  SUUSER1,
  SUUSER2,
  SUUSER3,
  SU_NOTES,
  SUSORT,
  SUPOSTCODE,
  SUBALANCE,
  SUTURNOVERYTD,
  SU_ON_STOP,
  SU_PRIMARY,
  SU_DO_NOT_USE,
  SU_CURR_CREDIT_LIMIT,
  SUBALANCE_C
from
  PL_ALLOC_HISTORY
  inner join PL_TRANSACTIONS on PL_TRANSACTIONS.PT_HEADER_KEY = PL_ALLOC_HISTORY.P_AL_HEADER_KEY
  inner join PL_ACCOUNTS     on PL_ACCOUNTS.SUCODE            = PL_ALLOC_HISTORY.P_AL_ACCOUNT_CODE