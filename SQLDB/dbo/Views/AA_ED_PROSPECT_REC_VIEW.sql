CREATE VIEW dbo.AA_ED_PROSPECT_REC_VIEW
AS
SELECT AA_ED_CUSTOMER_PROSPECT_VIEW.CUSTOMER_CODE,
	AD_CODE,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUSTOMER_TYPE,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUNAME,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUPOSTCODE,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUFAX,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUCONTACT,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUPHONE,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUSORT,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUUSER1,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUUSER2,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CUUSER3,
	AA_ED_CUSTOMER_PROSPECT_VIEW.CU_DEALERCODE,
	Dealer.CUNAME as DEALER_NAME,
	AD_CONTACT,
	AD_USERDATE1,
	AD_USERDATE2,
	AD_USERDATE3,
	AD_USERTEXT1,
	AD_USERTEXT2,
	AD_USERTEXT3,
	AD_USERTEXT4,
	AD_USERTEXT7,
	AD_USERTEXT8,
	AD_USERTEXT9,
	AD_USERTEXT10,
	AD_USERNUM1,
	AD_USERNUM2,
	AD_USERNUM3,
	AD_USERFLAG1,
	AD_USERFLAG2,
	AD_USERFLAG3,
	AD_USERFLAG4,
	AD_USER_PUTIN,
	AD_DATE_PUTIN,
	SL_AD_PRIMARY,
	AD_USER_ALOC,
	PUser.USER_NAME as PUSER_NAME,
	AUser.USER_NAME as AUSER_NAME,
	dbo.AA_ED_CUSTOMER_PROSPECT_VIEW.CU_PRIMARY
FROM SL_ADDRESSES
RIGHT JOIN AA_ED_CUSTOMER_PROSPECT_VIEW ON AD_ACC_CODE=CUSTOMER_CODE
LEFT OUTER JOIN AA_ED_CUSTOMER_PROSPECT_VIEW Dealer ON AA_ED_CUSTOMER_PROSPECT_VIEW.CU_DEALERCODE=Dealer.CUSTOMER_CODE
LEFT OUTER JOIN SYS_USER PUser ON AD_USER_PUTIN=PUser.USER_ID
LEFT OUTER JOIN SYS_USER AUser ON AD_USER_ALOC=AUser.USER_ID