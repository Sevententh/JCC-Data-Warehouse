CREATE VIEW AA_NET_PL_ACCOUNT_VIEW
/*
** Written:        17/09/02 SRB
** Last Amended: 29/11/02 SRB; 14/01/03 SRB; 14/03/03 ROBB; 18/03/03 ROBB, 04/06/04 NC, 13/05/05 NC
*/
AS

SELECT 

SUCODE,
SUNAME, 
SUADDRESS, 
SU_ADDRESS_USER1, 
SU_ADDRESS_USER2, 
SUPOSTCODE, 
SUPHONE,
SU_COUNTRY, 
SUFAX, 
SU_MOBILE_NUMBER, 
SU_EMAIL, 
SU_WEBSITE_ADDRESS, 
SUCURRENCYCODE,
SYS_CURRENCY.CURR_SYMBOL as CURRENCYSYMBOL,
SU_MULTI_CURR, 
SU_IMPORT_CODE, 
SU_ANALYSIS, 
PL_ANALYSIS.PACURRENCYSYMBL as ANALYSISCURRENCY, 
SU_TAX_CODE, 
SU_BANK_ANALYS,
PL_ANALYSIS_BANK.PACURRENCYSYMBL as BANKANALYSISCURRENCY, 
SU_VAT_REG_NO, 
SU_COUNTRY_CODE, 
SU_EC_DELIVERY, 
SU_EC_T_NATURE, 
SU_EC_T_MODE, 
SU_LANG_CODE, 
SU_LEVEL, 
SU_ON_STOP, 
SU_PRICE_KEY, 
dbo.AA_TWO_DPS_F(SU_TOT_DISC) AS SU_TOT_DISC, 
dbo.AA_TWO_DPS_F(SU_LINE_DISC) AS SU_LINE_DISC, 
dbo.AA_VALUE_DPS_F(SU_CREDIT_LIMIT) AS SU_CREDIT_LIMIT, 
SU_TERMS, 
dbo.AA_TWO_DPS_F(SU_SETT_DISC1) AS SU_SETT_DISC1, 
SU_SETT_DAYS1, 
dbo.AA_TWO_DPS_F(SU_SETT_DISC2) AS SU_SETT_DISC2, 
SU_SETT_DAYS2, 
dbo.AA_VALUE_DPS_F(SU_DEL_CHARGE) AS SU_DEL_CHARGE, 
dbo.AA_TWO_DPS_F(SU_DEL_CHG_PCNT) AS SU_DEL_CHG_PCNT, 
dbo.AA_VALUE_DPS_F(SU_MIN_ORDR) AS SU_MIN_ORDR, 
SU_A_P_DAYS, 
SU_DUEDATE_TYPE, 
SU_DUE_DAYS, 
SUSORT, 
SUUSER1, 
SUUSER2, 
SUUSER3, 
SU_NOTES, 
SU_CONTACT_COMPTYPE, 
SUCONTACT, 
SU_CONTACT_TITLE, 
SU_CONTACT_INITIALS, 
SU_CONTACT_SURNAME, 
SU_CONTACT_FIRSTNAME, 
SUSALUTE, 
SU_CONTACT_JOB, 
SU_BANK_SORT, 
SU_BANK_AC_NO, 
SU_BANK_BANKNAME, 
SU_BANK_BACSREF, 
SU_BANK_AC_NAME, 
SU_ISDN_NUMBER, 
SU_EDI_ANA, 
SU_EDI_SUPPIDN,
SU_USRCHAR1, 
SU_USRCHAR2, 
SU_USRCHAR3,
SU_USRCHAR4,
SU_USRCHAR5, 
SU_USRCHAR6, 
SU_USRCHAR7, 
SU_USRCHAR8, 
SU_USRDATE1, 
SU_USRDATE2, 
SU_USRDATE3, 
SU_USRFLAG1, 
SU_USRFLAG2, 
SU_USRFLAG3, 
SU_USRNUM1, 
SU_USRNUM2, 
SU_USRNUM3, 
SUUSED,
SU_DATE_PUTIN,
SU_DATE_EDITED,
SU_DATE_INV,
SU_DATE_PAY,
SU_INV_ADD_CDE,
SU_DEL_ADD_CDE,
SU_PRIMARY,
dbo.AA_VALUE_DPS_F(SUBALANCE) as SUBALANCE,
dbo.AA_VALUE_DPS_F(SUTURNOVERPTD) as SUTURNOVERPTD,
dbo.AA_VALUE_DPS_F(SUTURNOVERYTD) as SUTURNOVERYTD,
SU_IBAN_NO

FROM

PL_ACCOUNTS

LEFT OUTER JOIN PL_ACCOUNTS2 ON PL_ACCOUNTS.SUCODE = PL_ACCOUNTS2.SUCODE2
LEFT OUTER JOIN PL_ANALYSIS ON PL_ACCOUNTS.SU_ANALYSIS = PL_ANALYSIS.PACODE
LEFT OUTER JOIN PL_ANALYSIS AS PL_ANALYSIS_BANK ON PL_ACCOUNTS.SU_BANK_ANALYS = PL_ANALYSIS.PACODE
LEFT OUTER JOIN SYS_CURRENCY ON PL_ACCOUNTS.SUCURRENCYCODE = SYS_CURRENCY.CURR_CODE
